#include "DHT.h"

// --- CONFIGURATION ---
#define SOIL_PIN 35      // Input Only pin (Safe for analog)
#define DHT_PIN 4        // Digital I/O pin (Required for DHT)
#define DHTTYPE DHT22    // Change to DHT11 if your sensor is Blue

// Initialize the DHT sensor
DHT dht(DHT_PIN, DHTTYPE);

// Soil Calibration (Use your numbers)
const int dryValue = 3500;
const int wetValue = 1200;

void setup() {
  Serial.begin(115200);
  dht.begin(); // Start the temp sensor
  Serial.println("System Initializing...");
  delay(2000); // Give sensors time to warm up
}

void loop() {
  // --- READ SOIL ---
  int rawSoil = analogRead(SOIL_PIN);
  int soilPercent = map(rawSoil, dryValue, wetValue, 0, 100);
  soilPercent = constrain(soilPercent, 0, 100);

  // --- READ AIR ---
  // Reading temperature or humidity takes about 250 milliseconds!
  float humidity = dht.readHumidity();
  float tempC = dht.readTemperature();     // Celsius
  float tempF = dht.readTemperature(true); // Fahrenheit

  // Check if reading failed
  if (isnan(humidity) || isnan(tempC)) {
    Serial.println("Failed to read from DHT sensor!");
    return;
  }

  // --- PRINT DATA ---
  Serial.println("-------------------------");
  Serial.print("üå± Soil Moisture: ");
  Serial.print(soilPercent);
  Serial.println("%");
  
  Serial.print("üå°Ô∏è Temperature:   ");
  Serial.print(tempF);
  Serial.println("¬∞F");
  
  Serial.print("üíß Humidity:      ");
  Serial.print(humidity);
  Serial.println("%");

  // --- NEDC LOGIC ---
  // "If it is hotter than 90¬∞F, plants need higher soil moisture"
  if (tempF > 90) {
     Serial.println("‚ö†Ô∏è HEAT ALERT: Increasing water requirement!");
  }

  delay(2000); // Wait 2 seconds between readings
}
